function setPreviewToDocument(e){let t=document.getElementById("Modals"),l="/api/nav/db/#{DBID}#/attachments/##attachmentId##/preview?hash=0&amp;isdesignerdesk=0";if(l=l.replace("##attachmentId##",e),console.log("preview-url:"+l),null!=localStorage.getItem("WebconBPS_Impersonator")){var n=new XMLHttpRequest;n.open("GET",l),n.onreadystatechange=function(){if(this.readyState===this.DONE)if(200===this.status){var e=URL.createObjectURL(this.response);let l=previewHTML.replace("##iframeSrc##",e);l=l.replace("##documentName##",ccls_attachmentTitle),t.innerHTML=l,document.getElementById("modalContent").style.visibility="visible",document.getElementById("spinner-container").style.display="hidden"}else console.error("no pdf :(")},n.setRequestHeader("x-impersonateperson",JSON.parse(localStorage.getItem("WebconBPS_Impersonator")).login),n.responseType="blob",n.send()}else{let e=previewHTML.replace("##iframeSrc##",l);e=e.replace("##documentName##",ccls_attachmentTitle),t.innerHTML=e,document.getElementById("modalContent").style.visibility="visible",document.getElementById("spinner-container").style.display="hidden"}}window.dkr=window.dkr||{},dkr.showAllAttachments={},dkr.showAllAttachments.Timeout=0,dkr.showAllAttachments.TimeoutMax=4,dkr.showAllAttachments.execute=function(e,t,l){if(1==new URLSearchParams(document.location.search).get("debug"))debugger;var n=document.getElementsByClassName("all-attachments-link");null!=n&&1==n.length?(n[0].click(),null!=l&&dkr.showAllAttachments.executeCollapseFolders(0,4,l)):e<=t&&(e++,setTimeout((function(){dkr.showAllAttachments.execute(e,t,l)}),333))},dkr.showAllAttachments.executeCollapseFolders=function(e,t,l){if(1==new URLSearchParams(document.location.search).get("debug"))debugger;var n=document.querySelector("div.table-tree.all-attachments");null!=n&&0!=n.length?(document.querySelectorAll(`div.table-tree-column.level-${l}`,n),document.querySelectorAll(`div.table-tree-column.level-${l}`).forEach((e=>{e.click()}))):e<=t&&(e++,setTimeout((function(){dkr.showAllAttachments.executeCollapseFolders(e,t,l)}),333))},dkr.showAllAttachments.execute(0,4,1);