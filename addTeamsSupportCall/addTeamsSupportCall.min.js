window.dkr=window.dkr||{},dkr.teamsSupport={},dkr.teamsSupport.recipients=null,dkr.teamsSupport.hoverInformation=null,dkr.teamsSupport.icon="ms-Icon--UnknownCall",dkr.teamsSupport.message=null,dkr.teamsSupport.addUrlToMessage=!0,dkr.teamsSupport.useWebApp=!1,dkr.teamsSupport.startChat=function(t,e,o,r){console.log(`Starting teams chat for users: '${t}'`);let n=encodeURIComponent(t.replaceAll(";",",")),a=e||"";if(o){let t=document.location.href.substring(0,document.location.href.length-document.location.search.length);t=t.replace("edit","").replace("admin",""),a+=" "+t}r?window.open(`https://teams.microsoft.com:/l/chat/0/0?users=${n}&message=${encodeURIComponent(a)}`,"_blank"):window.open(`msteams:/l/chat/0/0?users=${n}&message=${encodeURIComponent(a)}`)},dkr.teamsSupport.prepareTeamsSupport=function(t,e){if(console.log("prepareTeamsSupport:"+t),null==dkr.teamsSupport.recipients||""==dkr.teamsSupport.recipients)return;let o=document.querySelector(".top-bar-toolbar-menu--placement-right");if(null==o)return void(t<e&&setTimeout((()=>{t++,dkr.teamsSupport.prepareTeamsSupport(t,e)}),50));let r=`\n  <div class="toolbar-button__wrapper">\n    <button id="dkrTeamsSupportLink" class="webcon-button toolbar-button__wrapper--toolbar-button webcon-button--padding-medium standard-focus-visible webcon-button--icon-button no-background th-hover" aria-label="Admin" id="AdminToolbarButton" tabindex="0" type="button">\n      <i class="icon ms-Icon ${dkr.teamsSupport.icon} ms-Icon--standard" aria-hidden="true" data-disabled="false">\n      </i>\n    </button></div>\n`;o.insertAdjacentHTML("afterbegin",r);let n=o.querySelector("button");n.title=dkr.teamsSupport.hoverInformation,n.onclick=()=>{dkr.teamsSupport.startChat(dkr.teamsSupport.recipients,dkr.teamsSupport.message,dkr.teamsSupport.addUrlToMessage,dkr.teamsSupport.useWebApp)}},console.log("Add Teams support call logic executed");