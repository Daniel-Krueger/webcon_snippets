if(-1==document.location.href.indexOf("isModal"))return;if(window.ccls=window.ccls||{},ccls.utils=ccls.utils||{},ccls.utils.getIdFromUrl=function(e,o){return void 0===o&&(o=document.location.href),o.match("/"+e+"/([0-9]*)/")[1]},ccls.modal=ccls.modal||{},ccls.modal.child=ccls.modal.child||{},ccls.modal.child.startDebugger=function(){if("modalDialogChild"==new URLSearchParams(document.location.search).get("debug")){debugger;return!0}return!1},ccls.modal.trackNavigation=ccls.modal.trackNavigation||{},ccls.modal.trackNavigation.onUrlChange=function(){ccls.modal.child.startDebugger(),document.location.href.indexOf("element/confirm")>-1?setTimeout((()=>{let e=$("a",$(".signature"))[0].href,o=ccls.utils.getIdFromUrl("element",e),t=ccls.utils.getIdFromUrl("db",e);parent.ccls.modal.dialog.close({dbId:t,instanceId:o})}),400):ccls.modal.trackNavigation.infiniteUrlChangeCheck=setTimeout(ccls.modal.trackNavigation.onUrlChange,250)},ccls.modal.trackNavigation.infiniteUrlChangeCheck=setTimeout(ccls.modal.trackNavigation.onUrlChange,250),(()=>{console.log("Styling the child dialog.");let e=document.createElement("style"),o="#ffab0045",t="#ff9c00c4";["a24dcfc2-2b14-4de8-8af3-7952a0a2cf61","6ec43cab-2ccf-438a-b0be-54388d7b43be"].indexOf(window.initModel.userTheme)>-1&&(o="#ff9c00c4",t="#ffab0045"),1==ccls.modal.showFullForm?e.innerHTML=`\n      .dynamic-form.modern #pathPanel \n      #cclsCloseDialogButton} {\n      background-color: ${o};\n      }\n      .dynamic-form.modern #pathPanel \n      #cclsCloseDialogButton:hover {\n      background-color: ${t};\n      }\n      `:e.innerHTML=`\n      .dynamic-form.modern #pathPanel \n      #cclsCloseDialogButton} {\n      background-color: ${o};\n      }\n      .dynamic-form.modern #pathPanel \n      #cclsCloseDialogButton:hover {\n      background-color: ${t};\n      }\n      .top-bar-header,\n      .ms-promotedActionButton-text {\n        display: none;\n      }\n\n      .redux-toastr {\n        display: none;\n      }\n      .rightBar {\n        display:none;\n      }\n      `,document.getElementsByTagName("head")[0].appendChild(e)})(),ccls.modal.closeButton=ccls.modal.closeButton||{},ccls.modal.closeButton.label="",ccls.modal.closeButton.tryCounter=0,ccls.modal.closeButton.addCloseDialogButton=function(){if(1!=$(".ms-promotedActionButton-text").length)return void(ccls.modal.closeButton.tryCounter<5?(ccls.modal.closeButton.tryCounter++,setTimeout(ccls.modal.addCloseDialogButton,100)):console.log("Try counter exceeded maximum tries, close button won't be added."));console.log("Add close button to path panel"),$(".pathPanelRow").prepend($(".path-button-container").first().wrapAll("<div>").parent().html());let e=$(".pathPanelButton:first");e.attr("id","cclsCloseDialogButton"),e.attr("value",ccls.modal.closeButton.label),e.click((function(){parent.ccls.modal.dialog.close()})),$(".form-button__title",e).text(ccls.modal.closeButton.label)},1==ccls.modal.closeButton.displayAsPath){switch(window.initModel.userLang.substr(0,2)){case"de":ccls.modal.closeButton.label="Dialog schlieÃŸen";break;default:ccls.modal.closeButton.label="Close dialog";break}$(document).ready((function(){setTimeout(ccls.modal.closeButton.addCloseDialogButton,100)}))}class Message{constructor(e,o){this.type=e,this.body=o}}window.addEventListener("message",(e=>{let o=e.data;if("sendURL"==o.type){let e;e=document.location.href.indexOf("start/wf")>-1?`/db/${ccls.utils.getIdFromUrl("db")}/app/${GetPairID(G_APP)}/start/wf/${ccls.utils.getIdFromUrl("wf")}/dt/${ccls.utils.getIdFromUrl("dt")}/form`+document.location.search:`/db/${ccls.utils.getIdFromUrl("db")}/app/${GetPairID(G_APP)}/element/${GetPairID(G_WFELEM)}/form`+document.location.search,window.parent.postMessage(new Message("fullUrl",{url:e}))}if("parentClosing"==o.type){if(-1==document.location.href.indexOf("start/wf")&&-1==document.location.href.indexOf("/confirm")){let e={method:"GET",headers:{}};console.log("Execute release checkout for child."),fetch(`/api/nav/db/${ccls.utils.getIdFromUrl("db")}/app/${ccls.utils.getIdFromUrl("app")}/element/${ccls.utils.getIdFromUrl("element")}/checkout/release`,e).then((()=>{}))}window.parent.postMessage(new Message("childClosed",o.body))}})),console.log("modal dialog child logic loaded");