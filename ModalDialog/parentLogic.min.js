window.ccls=window.ccls||{},ccls.modal=ccls.modal||{},ccls.modal.dialog=ccls.modal.dialog||{},ccls.modal.dialog.startDebugger=function(){if("modalDialogParent"==new URLSearchParams(document.location.search).get("debug")){debugger;return!0}return!1},ccls.modal.dialog.closingTimeout=null,ccls.modal.dialog.closeFunctions=ccls.modal.dialog.closeFunctions||{},ccls.modal.dialog.closeFunctions.displayAttachment=function(o){if(null!=o){if(void 0===o.dbId&&(o.dbId=ccls.utils.getIdFromUrl("db")),ccls.utils.continueAlsoPageIsDirty){var e=`"/api/nav/db/${o.dbId}/element/${o.elementId}/attachments/${o.attachmentId}/edit?withRedirect=true"`;console.log(`Opening edit document URL: '${e}'`),window.location=e}}else console.log("No parameters have been provided")},ccls.modal.dialog.closeFunctions.executeRefreshButton=function(o){if(!ccls.utils.continueAlsoPageIsDirty)return;let e=$("#ReloadToolbarButton");1==e.length&&e[0].click()},ccls.modal.dialog.closeFunctions.setInstanceIdForField=function(o,e){null!=o?SetValue(e,o.instanceId):console.log("No parameters have been provided")},ccls.modal.dialog.closeFunctions.setInstanceIdForItemListColumn=function(o,e,n,l){null!=o?void 0===l||-1===l?SetSubValue(e,SubelementCountRows(e),n,o.instanceId):SetSubValue(e,l,n,o.instanceId):console.log("No parameters have been provided")},ccls.modal.dialog.closeFunctions.setGuidForField=async function(o,e){if(null==o)return void console.log("No parameters have been provided");const n=await ccls.utils.getSpecificLiteModel(o.dbId,o.instanceId);ccls.modal.dialog.startDebugger(),SetValue(e,n.liteData.liteModel.formInfo.guid)},ccls.modal.dialog.closeFunctions.setGuidForItemListColumn=async function(o,e,n,l){if(null==o)return void console.log("No parameters have been provided");const t=await ccls.utils.getSpecificLiteModel(o.dbId,o.instanceId);ccls.modal.dialog.startDebugger(),void 0===l||-1===l?SetSubValue(e,SubelementCountRows(e),n,t.liteData.liteModel.formInfo.guid):SetSubValue(e,l,n,t.liteData.liteModel.formInfo.guid)},ccls.modal.dialog.customClosingFunction=void 0,ccls.modal.dialog.close=function(o){ccls.modal.dialog.startDebugger(),document.getElementById("cclsModaliframe").contentWindow.postMessage(new Message("parentClosing",o)),ccls.modal.dialog.closingTimeout=setTimeout(ccls.modal.dialog.childClosed,100,o)},ccls.modal.dialog.childClosed=function(o){clearTimeout(ccls.modal.dialog.closingTimeout),document.getElementById("cclsModal").style.display="none",document.getElementById("cclsModaliframe").src="about:blank",ccls.modal.dialog.customClosingFunction!=ccls.modal.dialog.closeFunctions.executeRefreshButton?($(".reload-button-container").find("button").each(((o,e)=>{e.click()})),$(".reload-button-container").find("span").each(((o,e)=>{e.click()})),"function"==typeof ccls.modal.dialog.customClosingFunction&&ccls.modal.dialog.customClosingFunction(o)):ccls.modal.dialog.closeFunctions.executeRefreshButton()},ccls.modal.dialog.displayWorkflow=function(o,e,n,l,t){ccls.modal.dialog.startDebugger(),console.log(e);let a=JSON.parse("{"+e+"}");if("number"!=typeof a.dbId&&(a.dbId=ccls.utils.getIdFromUrl("db")),"number"!=typeof a.elementId)return void alert(`Element id is not a number, passed value '${a.workflowId}'`);let d=ccls.modal.dialog.getSearchParams(n),c=`/embed/form/db/${a.dbId}/element/${a.elementId}/form?${d.toString()}&theme=${window.initModel.userTheme}`;ccls.modal.dialog.internalOpen(o,c,l,t)},ccls.modal.dialog.startWorkflow=function(o,e,n,l,t){ccls.modal.dialog.startDebugger(),console.log(e);let a=JSON.parse("{"+e+"}");if("number"!=typeof a.dbId&&(a.dbId=ccls.utils.getIdFromUrl("db")),"number"!=typeof a.workflowId)return void alert(`Workflow id is not a number, passed value '${a.workflowId}'`);if("number"!=typeof a.formTypeId)return void alert(`Form type id is not a number, passed value '${a.formTypeId}'`);let d=ccls.modal.dialog.getSearchParams(n);"number"!=typeof a.businessEntity&&(a.businessEntity=GetPairID(G_COM)),d.append("com_id",a.businessEntity),"number"==typeof a.parentInstance&&d.append("parent_wfdid",a.parentInstance);let c=`/embed/form/db/${a.dbId}/start/wf/${a.workflowId}/dt/${a.formTypeId}/form?${d.toString()}&theme=${window.initModel.userTheme}`;ccls.modal.dialog.internalOpen(o,c,l,t)},ccls.modal.dialog.internalOpen=function(o,e,n,l){console.log(e);let t=JSON.parse("{"+o+"}"),a=t[window.initModel.userLang.substr(0,2)];void 0===a&&(a=t.default),document.getElementById("cclsModaliframe").src=e,document.getElementById("cclsModalTitle").innerText=a,document.getElementById("cclsModal").style.display="block",null!=n&&(G_ISMOBILE&&(n=" height:95%; width:95%"),$(".modal-window").attr("style","z-index: 2003;"+n)),"function"==typeof l&&(ccls.modal.dialog.customClosingFunction=l)},ccls.modal.dialog.getSearchParams=function(o){console.log(o);let e=JSON.parse("{"+o+"}"),n=new URLSearchParams("isModal=1");for(const o in e){let l=e[o];l.toString().indexOf("WFD_")>-1&&(l=GetValue(l)),n.append(o,encodeURIComponent(l))}return ccls.modal.dialog.startDebugger()&&n.append("debug","modalDialogChild"),n},ccls.modal.dialog.startingLayoutDefinitionStyle=null,ccls.modal.dialog.toggleExpand=function(){ccls.modal.dialog.startDebugger(),$("#cclsModalLayoutDefinition").hasClass("expanded")?($("#cclsModalLayoutDefinition").removeClass("expanded"),$("#cclsModalLayoutDefinition").attr("style",ccls.modal.dialog.startingLayoutDefinitionStyle),$("#cclsExpandButtonIcon").addClass("ms-Icon--FullScreen"),$("#cclsExpandButtonIcon").removeClass("ms-Icon--BackToWindow")):(ccls.modal.dialog.startingLayoutDefinitionStyle=$("#cclsModalLayoutDefinition").attr("style"),$("#cclsModalLayoutDefinition").addClass("expanded"),$("#cclsModalLayoutDefinition").attr("style","z-index: 2003;height: 95%; width: 95%;"),$("#cclsExpandButtonIcon").addClass("ms-Icon--BackToWindow"),$("#cclsExpandButtonIcon").removeClass("ms-Icon--FullScreen"))},ccls.modal.dialog.replaceWindow=function(){ccls.modal.dialog.startDebugger(),ccls.utils.continueAlsoPageIsDirty()&&document.getElementById("cclsModaliframe").contentWindow.postMessage(new Message("sendURL",null))},ccls.modal.dialog.dialogHtml='\n  <div id="cclsModal" class="modal-outer" style="display:none">\n    <div\n      id="cclsModalLayoutDefinition"\n      class="modal-window animation100 modal-window--large"\n      style="z-index: 2003"\n    >\n      <header>\n        <div class="title-container expandable">\n          <div class="title" id="cclsModalTitle"></div>\n          <div class="subtitle"></div>\n        </div>\n\n        <div class="actions">\n        \x3c!-- reusing the expand class to match the styling, but moving the position of the element with the style --\x3e\n          <div id="cclsOpenInNewWindow" class="expand" style="right: 60px;">\n            <button\n              class="webcon-button webcon-button--padding-default standard-focus webcon-button--icon-button no-hover no-background th-hover"\n              aria-label="Close"\n              tabindex="0"\n              type="button"\n            >\n            <i class="icon ms-Icon ms-Icon--OpenInNewWindow ms-Icon--standard" aria-hidden="true" data-disabled="false"></i>\n         \n            </button>\n            </div>\n          <div id="cclsExpandDialog" class="expand">\n            <button\n              class="webcon-button webcon-button--padding-default standard-focus webcon-button--icon-button no-hover no-background th-hover"\n              aria-label="Full screen"\n              tabindex="0"\n              type="button"\n            >\n              <i\n                id="cclsExpandButtonIcon"\n                class="icon ms-Icon ms-Icon--FullScreen ms-Icon--standard"\n                aria-hidden="true"\n                data-disabled="false"\n              ></i>\n            </button>\n          </div>\n          <div id="cclsCloseDialog" class="close">\n            <button\n              class="webcon-button webcon-button--padding-default standard-focus webcon-button--icon-button no-hover no-background th-hover"\n              aria-label="Close"\n              tabindex="0"\n              type="button"\n            >\n              <i\n                class="icon ms-Icon ms-Icon--ChromeClose ms-Icon--standard"\n                aria-hidden="true"\n                data-disabled="false"\n              ></i>\n            </button>\n          </div>\n        </div>\n      </header>\n      <iframe id="cclsModaliframe" height="100%"></iframe>\n    </div>\n    <div class="modal-background animation04" style="z-index: 2002"></div>\n  </div>\n\n',$("#formContainer").append(ccls.modal.dialog.dialogHtml),$("#cclsCloseDialog > button").on("click",(function(){ccls.modal.dialog.close()})),$("#cclsExpandDialog > button").on("click",(function(){ccls.modal.dialog.toggleExpand()})),$("#cclsOpenInNewWindow > button").on("click",(function(){ccls.modal.dialog.replaceWindow()}));class Message{constructor(o,e){this.type=o,this.body=e}}window.addEventListener("message",(o=>{let e=o.data;"fullUrl"==e.type&&(e.body.url.indexOf("?")>-1?e.body.url+="&":e.body.url+="?",document.location.href=e.body.url+"returnUrl="+encodeURIComponent(document.location.href)),"childClosed"==e.type&&ccls.modal.dialog.childClosed(e.body)})),console.log("modal dialog parent logic executed");