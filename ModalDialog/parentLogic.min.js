window.ccls=window.ccls||{},ccls.modal=ccls.modal||{},ccls.modal.dialog=ccls.modal.dialog||{},ccls.modal.dialog.replaceWindowBehavior,ccls.modal.dialog.closeBtnLabel={de:"Schließen",en:"Close",pl:"Zamknij",it:"Chiudi",sl:"Zapri",ro:"Închide"},ccls.modal.dialog.downloadBtnLabel={de:"Download",en:"Download",pl:"Pobierz",it:"Scarica",sl:"Prenesi",ro:"Descarcă"},ccls.modal.dialog.closedParameters=null,ccls.modal.dialog.VersionDependingValues=[{version:"0.0.0.0",values:{encodeParametersTwice:!0,modalDialogContainerClasses:"modal-window animation100 modal-window--large",modalDialogHeaderElement:"header",modalDialogHeaderElementClasses:"modal-window__header",dialogStyling:function(){document.getElementById("cclsModalLayoutDefinition").style.padding="12px";let e=document.querySelector("#cclsModalLayoutDefinition .footer-right");e.style.display="flex",e.style.justifyContent="flex-end"}}},{version:"2023.1.3.118",values:{encodeParametersTwice:!1,modalDialogContainerClasses:"modal-window animation100 modal-window--large",modalDialogHeaderElement:"header",modalDialogHeaderElementClasses:"",dialogStyling:function(){document.getElementById("cclsModalLayoutDefinition").style.padding="12px";let e=document.querySelector("#cclsModalLayoutDefinition .footer-right");e.style.display="flex",e.style.justifyContent="flex-end",document.querySelector("#cclsModalLayoutDefinition #footerCloseButton").setAttribute("class","webcon-button animated modal-button th-button-default webcon-button--padding-default")}}},{version:"2025.1.1.1",values:{encodeParametersTwice:!1,modalDialogContainerClasses:"modal-window animation100 attachment-preview-modal modal-window--align-center",modalDialogHeaderElement:"div",modalDialogHeaderElementClasses:"modal-window__header",dialogStyling:function(){}}}],ccls.modal.dialog.versionValues=ccls.utils.getVersionValues(ccls.modal.dialog.VersionDependingValues),ccls.modal.dialog.startDebugger=function(){if("modalDialogParent"==new URLSearchParams(document.location.search).get("debug")){debugger;return!0}return!1},ccls.modal.dialog.getThemeGuid=function(){let e=document.body.className.split(" ").find((e=>e.startsWith("theme-")));return e?e.replace("theme-",""):"00000000-0000-0000-0000-000000000000"},ccls.modal.dialog.closingTimeout=null,ccls.modal.dialog.closeFunctions=ccls.modal.dialog.closeFunctions||{},ccls.modal.dialog.closeFunctions.executeRefreshButton=function(e){if(!ccls.utils.continueAlsoPageIsDirty)return;let t=$("#ReloadToolbarButton");1==t.length&&t[0].click()},ccls.modal.dialog.isFirstCall=function(e){return null==e?(console.log("No parameters have been provided"),ccls.modal.dialog.closedParameters=null,!1):(e.instanceId=e.instanceId??e.elementId,(ccls.modal.dialog.closedParameters?.dbId!=e.dbId||ccls.modal.dialog.closedParameters?.instanceId!=e.instanceId)&&(ccls.modal.dialog.closedParameters=e,!0))},ccls.modal.dialog.closeFunctions.setInstanceIdForField=function(e,t){ccls.modal.dialog.isFirstCall(e)&&SetValue(t,e.instanceId)},ccls.modal.dialog.closeFunctions.displayAttachment=function(e){if(ccls.modal.dialog.isFirstCall(e)&&(void 0===e.dbId&&(e.dbId=ccls.utils.getIdFromUrl("db")),ccls.utils.continueAlsoPageIsDirty)){var t=`"/api/nav/db/${e.dbId}/element/${e.elementId}/attachments/${e.attachmentId}/edit?withRedirect=true"`;console.log(`Opening edit document URL: '${t}'`),window.location=t}},ccls.modal.dialog.closeFunctions.setInstanceIdForItemListColumn=function(e,t,l,o){ccls.modal.dialog.isFirstCall(e)&&(void 0===o||-1===o?SetSubValue(t,SubelementCountRows(t),l,e.instanceId):SetSubValue(t,o,l,e.instanceId))},ccls.modal.dialog.closeFunctions.setGuidForField=async function(e,t){if(!ccls.modal.dialog.isFirstCall(e))return;const l=await ccls.utils.getSpecificLiteModel(e.dbId,e.instanceId);ccls.modal.dialog.startDebugger(),SetValue(t,l.liteData.liteModel.formInfo.guid)},ccls.modal.dialog.closeFunctions.setGuidForItemListColumn=async function(e,t,l,o){if(!ccls.modal.dialog.isFirstCall(e))return;const n=await ccls.utils.getSpecificLiteModel(e.dbId,e.instanceId);ccls.modal.dialog.startDebugger(),void 0===o||-1===o?SetSubValue(t,SubelementCountRows(t),l,n.liteData.liteModel.formInfo.guid):SetSubValue(t,o,l,n.liteData.liteModel.formInfo.guid)},ccls.modal.dialog.customClosingFunction=void 0,ccls.modal.dialog.close=function(e){ccls.modal.dialog.startDebugger(),document.removeEventListener("keydown",ccls.modal.dialog.closeOnEscape),document.getElementById("cclsModaliframe").contentWindow.postMessage(new Message("parentClosing",e)),ccls.modal.dialog.closingTimeout=setTimeout((()=>{console.log("Closing modal due to timeout"),ccls.modal.dialog.childClosed(e)}),100)},ccls.modal.dialog.closeOnEscape=function(e){"Escape"===e.key&&ccls.modal.dialog.close()},ccls.modal.dialog.childClosed=function(e){clearTimeout(ccls.modal.dialog.closingTimeout),document.getElementById("cclsModal").style.display="none",ccls.modal.dialog.customClosingFunction!=ccls.modal.dialog.closeFunctions.executeRefreshButton?($(".reload-button-container").find("button").each(((e,t)=>{setTimeout((()=>{t.click()}),122*e)})),$(".reload-button-container").find("span").each(((e,t)=>{setTimeout((()=>{t.click()}),99*e)})),"function"==typeof ccls.modal.dialog.customClosingFunction&&ccls.modal.dialog.customClosingFunction(e)):ccls.modal.dialog.closeFunctions.executeRefreshButton()},ccls.modal.dialog.displayAttachment=function(e,t,l){if(null==t)return void console.log("No parameters have been provided");void 0===t.dbId&&(t.dbId=ccls.utils.getIdFromUrl("db"));let o=document.getElementById("Modals");if("null"!=localStorage.getItem("WebconBPS_Impersonator")){var n=new XMLHttpRequest;n.open("GET",previewDocumentUrl),n.onreadystatechange=function(){if(this.readyState===this.DONE)if(200===this.status){var e=URL.createObjectURL(this.response);let t=previewHTML.replaceAll("##iframeSrc##",e);t=t.replaceAll("##documentName##",ccls_attachmentTitle),o.innerHTML=t,document.querySelector(".ccls-loading-container__children").style.visibility="visible",document.querySelector(".ccls-loading-container__spinner").style.visibility="hidden"}else console.error("no pdf :(")},n.responseType="blob",n.withCredentials=!0,n.setRequestHeader("x-impersonateperson",JSON.parse(localStorage.getItem("WebconBPS_Impersonator")).login),n.send()}else{var a=`/attachments/db/${t.dbId}/preview/${t.attachmentId}?hash=`+Date.now();console.log(`Display attachment: '${a}'`),ccls.modal.dialog.displayiFrame('"default":"'+e+'"',a,l,null,!1)}},ccls.modal.dialog.displayUrl=function(e,t,l){ccls.modal.dialog.startDebugger(),ccls.modal.dialog.displayiFrame('"default":"'+e+'"',t,l,null,!1)},ccls.modal.dialog.loadiFrameInBackground=function(e,t,l,o){ccls.modal.dialog.startDebugger(),ccls.modal.dialog.displayiFrame('"default":"'+e+'"',t,o,null,!1),ccls.modal.dialog.showModalDialogSpinner(l)},ccls.modal.dialog.displayWorkflow=function(e,t,l,o,n){ccls.modal.dialog.startDebugger(),console.log(t);let a=JSON.parse("{"+t+"}");if("number"!=typeof a.dbId&&(a.dbId=ccls.utils.getIdFromUrl("db")),"number"!=typeof a.elementId)return void alert(`Element id is not a number, passed value '${a.workflowId}'`);let d=ccls.modal.dialog.getSearchParams(l),i=`/embed/form/db/${a.dbId}/element/${a.elementId}/form?${d.toString()}&theme=${ccls.modal.dialog.getThemeGuid()}`;ccls.modal.dialog.displayiFrame(e,i,o,n,!0)},ccls.modal.dialog.startWorkflow=function(e,t,l,o,n){ccls.modal.dialog.startDebugger(),console.log(t);let a=JSON.parse("{"+t+"}");if("number"!=typeof a.dbId&&(a.dbId=ccls.utils.getIdFromUrl("db")),"number"!=typeof a.workflowId)return void alert(`Workflow id is not a number, passed value '${a.workflowId}'`);if("number"!=typeof a.formTypeId)return void alert(`Form type id is not a number, passed value '${a.formTypeId}'`);let d=ccls.modal.dialog.getSearchParams(l);"number"!=typeof a.businessEntity&&(a.businessEntity=GetPairID(G_COM)),d.append("com_id",a.businessEntity),"number"==typeof a.parentInstance&&d.append("parent_wfdid",a.parentInstance);let i=`/embed/form/db/${a.dbId}/start/wf/${a.workflowId}/dt/${a.formTypeId}/form?${d.toString()}&theme=${ccls.modal.dialog.getThemeGuid()}`;ccls.modal.dialog.displayiFrame(e,i,o,n,!0)},ccls.modal.dialog.displayiFrame=function(e,t,l,o,n){console.log(t);let a=document.getElementById("cclsModaliframe");a.src=t,a.style.display="block",document.getElementById("cclsModalInnerHtml").innerHTML="",document.getElementById("cclsOpenInNewWindow").style.display="block",ccls.modal.dialog.internalOpen(e,l,o,n),ccls.modal.dialog.showModalDialogContent()},ccls.modal.dialog.displayHTML=function(e,t,l,o){if(null==t)return void console.log("No parameters have been provided");let n=document.getElementById("cclsModaliframe");n.src="",n.style.display="none",document.getElementById("cclsModalInnerHtml").innerHTML=t.innerHTML,document.getElementById("cclsOpenInNewWindow").style.display="none",ccls.modal.dialog.internalOpen('"default":"'+e+'"',l,o,!1),ccls.modal.dialog.showModalDialogContent()},ccls.modal.dialog.internalOpen=function(e,t,l,o){let n=JSON.parse("{"+e+"}"),a=n[window.initModel.userLang.substr(0,2)];void 0===a&&(a=n.default),ccls.modal.dialog.replaceWindowBehavior=void 0===o||1==o?"workflowInstance":"external",document.getElementById("cclsModalTitle").innerText=a,null==t&&(t="height:95%; width:95%"),G_ISMOBILE&&(t=" height:95%; width:95%"),$(".modal-window").attr("style","z-index: 2003;"+t),document.getElementById("cclsModal").style.display="block",document.addEventListener("keydown",ccls.modal.dialog.closeOnEscape),"function"==typeof l&&(ccls.modal.dialog.customClosingFunction=l),ccls.modal.dialog.versionValues.dialogStyling()},ccls.modal.dialog.getSearchParams=function(e){console.log(e);let t=JSON.parse("{"+e+"}"),l=new URLSearchParams("isModal=1");for(const e in t){let o=t[e];o.toString().indexOf("WFD_")>-1&&(o=GetValue(o.replace("WFD_",""))),l.append(e,ccls.modal.dialog.versionValues.encodeParametersTwice?encodeURIComponent(o):o)}return ccls.modal.dialog.startDebugger()&&l.append("debug","modalDialogChild"),l},ccls.modal.dialog.startingLayoutDefinitionStyle=null,ccls.modal.dialog.showModalDialogContent=function(){document.getElementById("cclsModal").style.display="block",document.querySelector(".ccls-loading-container__spinner").style.display="none",document.querySelector(".ccls-loading-container__children").style.display="block",document.querySelector(".ccls-loading-container__children").style.opacity=100,document.getElementById("cclsModalDialogSpinnerText").innerText=null},ccls.modal.dialog.showModalDialogSpinner=function(e){document.getElementById("cclsModal").style.display="block",document.querySelector(".ccls-loading-container__spinner").style.display="block",document.querySelector(".ccls-loading-container__children").style.display="block",document.querySelector(".ccls-loading-container__children").style.opacity=0,document.getElementById("cclsModalDialogSpinnerText").innerText=e},ccls.modal.dialog.toggleExpand=function(){ccls.modal.dialog.startDebugger(),$("#cclsModalLayoutDefinition").hasClass("expanded")?($("#cclsModalLayoutDefinition").removeClass("expanded"),$("#cclsModalLayoutDefinition").attr("style",ccls.modal.dialog.startingLayoutDefinitionStyle),$("#cclsExpandButtonIcon").addClass("ms-Icon--FullScreen"),$("#cclsExpandButtonIcon").removeClass("ms-Icon--BackToWindow")):(ccls.modal.dialog.startingLayoutDefinitionStyle=$("#cclsModalLayoutDefinition").attr("style"),$("#cclsModalLayoutDefinition").addClass("expanded"),$("#cclsModalLayoutDefinition").attr("style","z-index: 2003;height: 95%; width: 95%;"),$("#cclsExpandButtonIcon").addClass("ms-Icon--BackToWindow"),$("#cclsExpandButtonIcon").removeClass("ms-Icon--FullScreen"))},ccls.modal.dialog.replaceWindow=function(){ccls.modal.dialog.startDebugger(),ccls.modal.dialog.close(),"workflowInstance"==ccls.modal.dialog.replaceWindowBehavior?document.getElementById("cclsModaliframe").contentWindow.postMessage(new Message("sendURL",null)):(console.log("open iframe url in new tab"),window.open(document.getElementById("cclsModaliframe").src,"_blank"))},ccls.modal.dialog.dialogHtml=`<style>\n  #cclsModal {\n    font-family: var(--fontFamilyBase);  \n  }\n  #cclsModalLayoutDefinition  > ${ccls.modal.dialog.versionValues.modalDialogHeaderElement} {\n    cursor:move;\n  }\n  #cclsModal" .modal-window {\n    max-height: calc(100% - 10px);\n    top: 5px;\n  }\n  #cclsModalTitle {\n    font-weight: 600;\n    font-size: var(--fontSize20);    \n  }\n.ccls-loading-container__spinner .webcon-ui{  \n    display: flex;\n    align-items: center;\n    flex-direction: column;\n}\n  </style>\n <div id="cclsModal" class="modal-outer" style="display:none">\n\t<div id="cclsModalLayoutDefinition" class="${ccls.modal.dialog.versionValues.modalDialogContainerClasses}" style="z-index: 2003">\n\t\t<${ccls.modal.dialog.versionValues.modalDialogHeaderElement} class=${ccls.modal.dialog.versionValues.modalDialogHeaderElementClasses}>\n\t\t<div class="title-container expandable">\n\t\t\t<div class="title" id="cclsModalTitle"></div>\n\t\t\t<div class="subtitle"></div>\n\t\t</div>\n\t\t<div class="actions">\n\t\t\t\x3c!-- reusing the expand class to match the styling, but moving the position of the element with the style --\x3e\n\t\t\t<div id="cclsOpenInNewWindow" class="expand" style="right: 60px;">\n\t\t\t\t<button class="webcon-button webcon-button--padding-default standard-focus webcon-button--icon-button no-hover no-background th-hover" aria-label="Close" tabindex="0" type="button">\n\t\t\t\t\t<i class="icon ms-Icon ms-Icon--OpenInNewWindow ms-Icon--standard" aria-hidden="true" data-disabled="false"></i>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div id="cclsExpandDialog" class="expand">\n\t\t\t\t<button class="webcon-button webcon-button--padding-default standard-focus webcon-button--icon-button no-hover no-background th-hover" aria-label="Full screen" tabindex="0" type="button">\n\t\t\t\t\t<i id="cclsExpandButtonIcon" class="icon ms-Icon ms-Icon--FullScreen ms-Icon--standard" aria-hidden="true" data-disabled="false"></i>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div id="cclsCloseDialog" class="close">\n\t\t\t\t<button class="webcon-button webcon-button--padding-default standard-focus webcon-button--icon-button no-hover no-background th-hover" aria-label="Close" tabindex="0" type="button">\n\t\t\t\t\t<i class="icon ms-Icon ms-Icon--ChromeClose ms-Icon--standard" aria-hidden="true" data-disabled="false"></i>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t</${ccls.modal.dialog.versionValues.modalDialogHeaderElement}>\n\t<div class="modal-window__section modal-window__section--no-padding" style="height:100%">\n\t\t\x3c!-- <iframe id="cclsModaliframe" height="100%" width="100%" style="border:0px"></iframe> --\x3e\n\t\t<div class="attachment-preview-modal__content" style="height:100%">\n\t\t\t<div class="loading-container" aria-busy="false" style="height:100%">\n\t\t\t\t<div class="loading-container__spinner ccls-loading-container__spinner">\n\t\t\t\t\t<div class="loading-container__spinner-overlay"></div>\n\t\t\t\t\t<div class="loading-container__spinner-image">\n\t\t\t\t\t\t<div aria-label="Loading" role="progressbar" class="webcon-ui spinner spinner--left">\n              <div id="cclsModalDialogSpinnerText"></div>\n\n\t\t\t\t\t\t\t<div class="webcon-ui spinner__circle spinner__circle--primary spinner__circle--huge">\n\t\t\t\t\t\t\t\t<div class="webcon-ui spinner__circle-outline">\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="loading-container__children ccls-loading-container__children" style="height:100%">\n\t\t\t\t\t<div class="attachment-preview-modal__loading-frame" style="height:100%">\n\t\t\t\t\t\t\x3c!-- <iframe id="cclsModaliframe" class="attachment-preview-modal__content__frame" src="##iframeSrc##" style=""/> --\x3e\n\t\t\t\t\t\t<iframe id="cclsModaliframe" class="attachment-preview-modal__content__frame" height="100%" width="100%" style="border:0px"></iframe>\n            <div id="cclsModalInnerHtml"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\x3c!-- <div class="modal-background animation04" style="z-index: 2002"></div> --\x3e\n\t<div class="footer">\n\t\t<div class="footer-right">\n\t\t\t\x3c!-- \n        <button class="webcon-ui button button--primary button--medium animated standard-focus-visible attachment-preview-modal__download-button modal-button attachment-preview-modal__content__button" type="button" data-key="Download">\n          <span class="webcon-ui text text__body-1-strong text__base button__content">Download</span>\n        </button>\n        --\x3e\n\t\t\t<button id="footerCloseButton" class="webcon-ui button button--default button--medium animated standard-focus-visible attachment-preview-modal__close-button modal-button attachment-preview-modal__content__button" type="button" data-key="Close">\n\t\t\t\t<span class="webcon-ui text text__body-1-strong text__base button__content">Close</span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n</div>\n`,$("#formContainer").append(ccls.modal.dialog.dialogHtml),$("#cclsCloseDialog > button").on("click",(function(){ccls.modal.dialog.close()})),$("#footerCloseButton").on("click",(function(){ccls.modal.dialog.close()})),$("#cclsExpandDialog > button").on("click",(function(){ccls.modal.dialog.toggleExpand()})),$("#cclsOpenInNewWindow > button").on("click",(function(){ccls.modal.dialog.replaceWindow()})),ccls.modal.dialog.dragElement=function(e){var t=0,l=0,o=0,n=0;function a(a){(a=a||window.event).preventDefault(),t=o-a.clientX,l=n-a.clientY,o=a.clientX,n=a.clientY,e.style.top=e.offsetTop-l+"px",e.style.left=e.offsetLeft-t+"px"}function d(){document.onmouseup=null,document.onmousemove=null}e.onmousedown=function(e){(e=e||window.event).preventDefault(),o=e.clientX,n=e.clientY,document.onmouseup=d,document.onmousemove=a}},ccls.modal.dialog.dragElement(document.querySelector("#cclsModalLayoutDefinition"));class Message{constructor(e,t){this.type=e,this.body=t}}void 0!==ccls.modal.dialog.abortController&&ccls.modal.dialog.abortController.abort("Cleaning up parent logic post message handler"),ccls.modal.dialog.abortController=new AbortController,ccls.modal.dialog.parentMessageHandler=function(e){if(e.data){let t=e.data;if("fullUrl"==t.type){t.body.url.indexOf("?")>-1?t.body.url+="&":t.body.url+="?";let e=t.body.url+"returnUrl="+encodeURIComponent(document.location.href);window.open(e,"_blank")}"childClosed"==t.type&&ccls.modal.dialog.childClosed(t.body)}},window.addEventListener("message",ccls.modal.dialog.parentMessageHandler,{signal:ccls.modal.dialog.abortController.signal}),console.log("modal dialog parent logic executed");