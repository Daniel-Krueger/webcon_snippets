window.dkr=window.dkr||{},dkr.infoPanelDetailsModification={},dkr.infoPanelDetailsModification.useGroupTaskHover=!1,dkr.infoPanelDetailsModification.useNewTaskIcon=!1,dkr.infoPanelDetailsModification.useStartTeamsChatFromTasks=!1,dkr.infoPanelDetailsModification.DOMUpdateDelay=50,dkr.infoPanelDetailsModification.attachInfoButtonClick=function(){const a=document.querySelector("button.infoBtn");a&&a.addEventListener("click",dkr.infoPanelDetailsModification.infoButtonClick)},dkr.infoPanelDetailsModification.attachInfoPanelDetailsClick=function(){const a=document.querySelector("i.ms-Icon--Storyboard");if(a){const i=a.closest("div");i&&i.addEventListener("click",dkr.infoPanelDetailsModification.infoPanelDetailsClick)}},dkr.infoPanelDetailsModification.infoButtonClick=function(){setTimeout((()=>{dkr.infoPanelDetailsModification.attachInfoPanelDetailsClick(),dkr.infoPanelDetailsModification.executeModification()}),dkr.infoPanelDetailsModification.DOMUpdateDelay)},dkr.infoPanelDetailsModification.infoPanelDetailsClick=function(){setTimeout(dkr.infoPanelDetailsModification.executeModification,dkr.infoPanelDetailsModification.DOMUpdateDelay)},dkr.infoPanelDetailsModification.executeModification=function(){1==dkr.infoPanelDetailsModification.useStartTeamsChatFromTasks&&dkr.infoPanelDetailsModification.addTeamsChatToTasks.replaceUserWithTeamsLink(),1==dkr.infoPanelDetailsModification.useNewTaskIcon&&dkr.infoPanelDetailsModification.changeUserIconForNewTasks.changeIcons(),1==dkr.infoPanelDetailsModification.useGroupTaskHover&&dkr.infoPanelDetailsModification.groupTaskHover.addHoverEffect()},dkr.infoPanelDetailsModification.init=function(a){void 0===a&&(a=200),setTimeout((()=>{dkr.infoPanelDetailsModification.attachInfoButtonClick(),dkr.infoPanelDetailsModification.attachInfoPanelDetailsClick(),dkr.infoPanelDetailsModification.executeModification()}),a)},dkr.infoPanelDetailsModification.changeUserIconForNewTasks={},dkr.infoPanelDetailsModification.changeUserIconForNewTasks.incompleteTaskIcon="ms-Icon--FollowUser",dkr.infoPanelDetailsModification.changeUserIconForNewTasks.newTaskIcon="ms-Icon--D365TalentInsight",dkr.infoPanelDetailsModification.changeUserIconForNewTasks.taskIds=[],dkr.infoPanelDetailsModification.changeUserIconForNewTasks.changeIcons=function(){const a=document.querySelector(".formElementInfoPanel");null!=a&&dkr.infoPanelDetailsModification.changeUserIconForNewTasks.taskIds.forEach((i=>{iconElement=document.querySelector(`div[data-task-id='${i}'] i`,a),null!=iconElement&&(iconElement.classList.remove(dkr.infoPanelDetailsModification.changeUserIconForNewTasks.incompleteTaskIcon),iconElement.classList.add(dkr.infoPanelDetailsModification.changeUserIconForNewTasks.newTaskIcon))}))},dkr.infoPanelDetailsModification.addTeamsChatToTasks={},dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList=null,dkr.infoPanelDetailsModification.addTeamsChatToTasks.message=null,dkr.infoPanelDetailsModification.addTeamsChatToTasks.addUrlToMessage=!1,dkr.infoPanelDetailsModification.addTeamsChatToTasks.useWebApp=!1,dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList=function(a){a.forEach((a=>{null!=a.taskId&&0==a.toGroup&&a.userLogin.indexOf("@")>-1&&(dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList[a.taskId]=a)}))},dkr.infoPanelDetailsModification.addTeamsChatToTasks.createTaskList=async function(){if(!window.ccls||!window.ccls.utils)return void console.warn("Common functions (utils.js) has not been loaded.");let a=await ccls.utils.getLiteModel();dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList={},dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.otherTasks.ccCoversTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.otherTasks.ccTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.otherTasks.directCoversTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.otherTasks.directTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.standardTasks.ccCoversTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.standardTasks.ccTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.standardTasks.directCoversTasks),dkr.infoPanelDetailsModification.addTeamsChatToTasks.addTaskArrayToTaskList(a.formInfo.tasksInfo.standardTasks.directTasks)},dkr.infoPanelDetailsModification.addTeamsChatToTasks.replaceUserWithTeamsLink=async function(){const a=document.querySelector(".formElementInfoPanel");if(null!=a){if(null==dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList&&await dkr.infoPanelDetailsModification.addTeamsChatToTasks.createTaskList(),null==dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList)return;Object.keys(dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList).forEach((i=>{let o=dkr.infoPanelDetailsModification.addTeamsChatToTasks.taskList[i],e=dkr.infoPanelDetailsModification.addTeamsChatToTasks.message||"";if(dkr.addTeamsChatToFields.addUrlToMessage){let a=document.location.href.substring(0,document.location.href.length-document.location.search.length);a=a.replace("edit","").replace("admin",""),e+=" "+a}let n=document.querySelector(`div[data-task-id='${o.taskId}'] .form-status-panel`,a);n.insertAdjacentHTML("beforeEnd",`\n                <i class="icon ms-Icon ms-Icon--TeamsLogo ms-Icon--small form-status-panel__icon" aria-hidden="true" data-disabled="false"></i>                \n                <a href="${dkr.infoPanelDetailsModification.addTeamsChatToTasks.useWebApp?"https://teams.microsoft.com":"msteams:"}/l/chat/0/0?users=${o.userLogin}&message=${encodeURIComponent(e)}" ${dkr.infoPanelDetailsModification.addTeamsChatToTasks.useWebApp?'target="_blank"':null}>\n                </a>\n                `);let s=n.querySelector("span");s.style.minWidth="100%",n.querySelector("a").appendChild(s)}))}},dkr.infoPanelDetailsModification.groupTaskHover={},dkr.infoPanelDetailsModification.groupTaskHover.groupMembers=[],dkr.infoPanelDetailsModification.groupTaskHover.addHoverEffect=function(){const a=document.querySelector(".formElementInfoPanel");null!=a&&dkr.infoPanelDetailsModification.groupTaskHover.groupMembers.forEach((i=>{const o=document.querySelector(`div[data-task-id='${i.TaskId}']`,a);if(null!=o){const a=o.querySelector("span");null!=a&&(a.addEventListener("mouseenter",(()=>{const o=document.createElement("div");o.classList.add("dkr-group-hover-info"),o.innerHTML=i.Users.map((a=>a.Name)).join("<br>"),a.appendChild(o)})),a.addEventListener("mouseleave",(()=>{const i=a.querySelector(".dkr-group-hover-info");i&&a.removeChild(i)})))}}))},console.log("Info panel modification has been loaded.");